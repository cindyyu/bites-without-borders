<!DOCTYPE html>
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script>
      var addNewIngredient = function() {
        $("div#ingredientcontainer").append("<input type='text' class='ingredient' /><br />");
      }
      var submitNewRecipe = function(e) {
        // prevents it from submitting initially
        e.preventDefault();
        // creates an array and adds every ingredient entered
        var ingredients = []
        $("input.ingredient").each(
          function() {
            ingredients[ingredients.length] = $(this).val();
          }
        );
        // creates a string that we'll decode in python 
        ingredientsString = "";
        for (i = 0; i < ingredients.length; i++) {
          if (i == 0) {
            ingredientsString = "[\"" + ingredients[i] + "\"";
          } else if (i == ingredients.length - 1) {
            ingredientsString = ingredientsString + ", \"" + ingredients[i] + "\"]";
          } else {
            ingredientsString = ingredientsString + ", \"" + ingredients[i] + "\"";
          }
        }
        // adds that string to a hidden textfield 
        $("#allIngredients").val( ingredientsString );
        $("form").submit();
      }
      $(document).ready(
        function() {
          $("a#newRow").on('click', addNewIngredient);
          $("input[type=submit]").on('click', submitNewRecipe);
        }
      );
    </script>
  </head>
  <body>
    {{ header }}
    <h2>New Recipe</h2>
    <form action="" method="post">
      <label for="name">Recipe Name</label><br />
      <input type="text" name="name" /><br />
      <label for="cooktime">Cook Time</label><br />
      <input type="text" name="cooktime" /><br />
      <label for="instructions">Instructions</label><br />
      <textarea name="instructions" placeholder="instructions here"></textarea><br />
      <label for="servings">Servings</label><br />
      <input type="text" name="servings" /><br />
      <input type="hidden" name="author" value="{{ userID }}" /><br />
      <label for="location">Location</label><br />
      <input type="text" name="location" /><br />
      <label for="ingredients">Ingredients</label><br />
      <div id="ingredientcontainer">
        <input type="text" class="ingredient" /><br />
      </div><br />
      <a id="newRow" href="#">add new ingredient</a><br />
      <input type="hidden" name="ingredients" id="allIngredients" />
      <input type="submit" value="submit" />
    </form>
  </body>
</html>